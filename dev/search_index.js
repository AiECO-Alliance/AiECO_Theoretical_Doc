var documenterSearchIndex = {"docs":
[{"location":"AiECO_SnowCore/#AiECO-Snowpack-Model","page":"AiECO_SnowCore","title":"AiECO Snowpack Model","text":"This page documents the Snow module API used by AiECO.","category":"section"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.hmean","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.hmean","text":"hmean(a, b, da, db) -> hm\n\nHarmonic mean helper used for interface conductances.\n\n$\n\n\\mathrm{hm} \\,=\\, \\begin{cases} \\dfrac{2ab}{a\\,db + b\\,da}, & a\\,db + b\\,da > 0 \\\n0, & \\text{otherwise} \\end{cases} $\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.cap_remove","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.cap_remove","text":"cap_remove(x, V, xA) -> x_capped\n\nCap a (possibly negative) tendency/flux x so it cannot remove more than V*xA in one substep.\n\n$\n\nx{\\mathrm{capped}} = \\max\\big(x,\\,-\\max(0, V\\,xA)\\big) $\n\nThis is the same limiter pattern used repeatedly in the ecosys-style code to enforce non-negativity of water stores under explicit splitting.\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.vpsat","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.vpsat","text":"vpsat(TK) -> υsat\n\nEcosys-style saturation vapor \"VP\" used by the snow solver.\n\nSaturation form (as in your translation):\n\n$\n\n\\upsilon^{\\ast}(T) = \\frac{2.173\\times 10^{-3}}{T}\\,(0.61)\\, \\exp!\\left[5360\\left(3.661\\times 10^{-3}-\\frac{1}{T}\\right)\\right] $\n\nNotes\n\nThis is not saturation vapor pressure in Pa.\nIt is consistent with the model’s internal “vapor concentration / water-equivalent” convention, commonly used as (\\upsilon \\approx V^{v}/V^{a}) where:\n(V^{v}) is a vapor water-equivalent store\n(V^{a}) is air-filled volume\nInput (T) is in Kelvin.\n\nReturns\n\nυsat: (\\upsilon^{\\ast}(T)) in the model’s internal units.\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.layer_props!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.layer_props!","text":"layer_props!(Va, υ, C, dz, Vlyr, Vs, Vw, Vi, Vv, cs, cw, ci, A)\n\nCompute per-layer helper properties used by transport and sources.\n\nDefinitions (per layer (L)):\n\nAir-filled volume: $ V^{a}L = \\max\\left(0,\\;V^{lyr}L - V^{s}L - V^{w}L - V^{i}_L\\right) $\n\nVapor “concentration” (internal convention): $ \\upsilonL = \\begin{cases} V^{v}L / V^{a}L, & V^{a}L>0\\\n0, & V^{a}_L=0 \\end{cases} $\n\nHeat capacity (per ground area): $ CL = cs V^{s}L + cw(V^{w}L+V^{v}L) + ci V^{i}L $\n\nLayer thickness: $ \\Delta zL = V^{lyr}L / A $\n\nInputs\n\nVlyr[L]: total layer volume per ground area (your snow_VolLyr_L[L] concept)\nVs,Vw,Vi,Vv[L]: stores (water-equivalent volumes per ground area)\ncs,cw,ci: heat capacities per water-equivalent volume\nA: area scaling (often Area[3,NUM])\n\nOutputs (written in-place)\n\nVa[L]: (V^{a}_L)\nυ[L]: (\\upsilon_L)\nC[L]: (C_L)\ndz[L]: (\\Delta z_L)\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.surf_flux","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.surf_flux","text":"surf_flux(T, Vs, Vw, Vi;\n          SW, LW, epsσ,\n          Tc, fc, Td, fd,\n          Ta, υa,\n          Ke, Kh,\n          Lv, Ls, cw, cs,\n          Ps, Pw, Pi, Qin,\n          xA) -> (Fs, Fw, Fi, Fh, diag)\n\nSnow surface exchange for the top snow layer (surface layer (L=1)).\n\nThis computes surface energy/mass exchange and returns the boundary fluxes at the snow–atmosphere interface (interface (1/2)).\n\nState (top layer)\n\n(V^{s},V^{w},V^{i}): snow/solid, liquid water, and ice stores\n(T): snow surface-layer temperature (K)\n\nForcing/parameters\n\nRadiation: (SW{\\downarrow}, LW{\\downarrow}), emission factor (\\varepsilon\\sigma)\nCanopy/standing-dead LW exchange: ((Tc,fc)), ((Td,fd))\nAir: ((Ta,\\upsilona))\nBulk transfer coefficients: (Ke) (vapor), (Kh) (sensible)\nLatent constants: ((Lv,Ls))\nExchanged-mass heat capacities: ((cw,cs))\nPrecip/additions: ((P^{s},P^{w},P^{i},Q_{in}))\nLimiter factor: xA (your ecosys-style per-substep cap, e.g. XNPAX)\n\nEquations\n\nAlbedo closure (volume-weighted): $ \\alpha = \\frac{0.85\\,V^{s}+0.30\\,V^{i}+0.06\\,V^{w}}{V^{s}+V^{i}+V^{w}} $\n\nNet radiation: $ Rn = (1-\\alpha)SW{\\downarrow}+LW{\\downarrow} -\\varepsilon\\sigma T^{4} +\\varepsilon\\sigma(Tc^{4}-T^{4})fc +\\varepsilon\\sigma(Td^{4}-T^{4})f_d $\n\nVapor exchange: $ E^{\\ast} = Ke\\big(\\upsilona-\\upsilon^{\\ast}(T)\\big) $\n\nPartition (capped by availability): $ E^{w}=\\max!\\left(E^{\\ast},\\; -\\,V^{w}xA\\right),\\qquad E^{s}=\\max!\\left(\\min!(0,E^{\\ast}-E^{w}),\\; -\\,V^{s}xA\\right) $\n\nLatent + sensible: $ LE = Lv E^{w} + Ls E^{s},\\qquad H = Kh\\,(Ta-T) $\n\nAdvective/enthalpy correction (your sign rule): $ Hv = \\begin{cases} (cwE^{w}+csE^{s})\\,T,   & E^{\\ast}<0\\\n(cwE^{w}+csE^{s})\\,Ta, & E^{\\ast}\\ge 0 \\end{cases} $\n\nTotal surface energy into snow: $ G0 = Rn + LE + H + H_v $\n\nBoundary fluxes at interface (1/2): $ F^{s}{1/2}=P^{s}+E^{s},\\quad F^{w}{1/2}=P^{w}+E^{w},\\quad F^{i}{1/2}=P^{i},\\quad F^{h}{1/2}=Q{in}+G0 $\n\nOutputs\n\nReturns (Fs, Fw, Fi, Fh, diag) where:\nFs,Fw,Fi,Fh correspond to (F^{s}{1/2},F^{w}{1/2},F^{i}{1/2},F^{h}{1/2})\ndiag is a NamedTuple of helpful diagnostics ((\\alpha,Rn,E^{w},E^{s},LE,H,Hv,G_0)).\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.surf_flux!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.surf_flux!","text":"surf_flux!(Fs, Fw, Fi, Fh, T, Vs, Vw, Vi; kwargs...)\n\nIn-place wrapper for surf_flux that writes fluxes into Refs:\n\nFs[] = F^{s}_{1/2}\nFw[] = F^{w}_{1/2}\nFi[] = F^{i}_{1/2}\nFh[] = F^{h}_{1/2}\n\nSee surf_flux for equations and parameter meanings.\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.flux_internal!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.flux_internal!","text":"flux_internal!(Fw, Fv, Fh, Vs, Vw, T, Va, υ, dz, k, Dv;\n               A, fs, cw, xA, xY, θmin)\n\nCompute internal interface fluxes inside the snowpack.\n\nIndex convention for interface arrays (length (J+1)):\n\nindex 1  = interface (1/2) (set by surf_flux!)\nindex L+1 = interface (L+1/2)\nindex J+1 = interface (J+1/2) (set by bottom_exchange!)\n\nTypical equations (implementation pattern)\n\nLiquid percolation (excess rule): $ q^{w}{L+1/2} = \\min!\\left(\\theta^{a}{L+1},\\; \\max(0, V^{w}{L}-0.05V^{s}{L})\\,x_A\\right) $\n\nVapor diffusion: $ q^{v}{L+1/2} = K^{v}{L+1/2}\\,(\\upsilon{L}-\\upsilon{L+1}) $\n\nHeat flux (conduction + liquid enthalpy): $ q^{h}{L+1/2} = K^{h}{L+1/2}(TL-T{L+1}) + cw TL\\,q^{w}_{L+1/2} $\n\nImplementation notes\n\nHarmonic means are used for conductances: (K^{v}{L+1/2}\\leftarrow\\mathrm{hmean}(Dv[L],Dv[L+1],\\Delta zL,\\Delta z{L+1})), (K^{h}{L+1/2}\\leftarrow\\mathrm{hmean}(k[L],k[L+1],\\Delta zL,\\Delta z{L+1})).\nθmin prevents zero “receiving capacity” in very dry/degenerate states; replace with your own physically-based cap if desired.\nxY is a scaling factor that you can use to mirror your XNPYX-style interface scaling; set xY=1.0 if you don’t need it.\n\nInputs\n\nLayer arrays: Vs,Vw,T,Va,υ,dz,k,Dv\nScalars: A (area factor), fs (snow cover), cw, xA, xY, θmin\n\nOutputs\n\nWrites for (L=1..J-1):\nFw[L+1] = liquid flux across (L+1/2)\nFv[L+1] = vapor flux across (L+1/2) scaled by A*fs*xY\nFh[L+1] = heat flux across (L+1/2) scaled by A*fs*xY\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.vapor_relax!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.vapor_relax!","text":"vapor_relax!(Vs, Vw, Vv, Va, T; Lv, Ls, xA) -> (Ww, Ws, Qv)\n\nIn-layer vapor relaxation toward saturation.\n\nThis is the layer-local evaporation/condensation adjustment used to relax the vapor store (V^{v}) toward (\\upsilon^{\\ast}(T)V^{a}).\n\nEquations\n\n$\n\n\\delta = V^{v} - \\upsilon^{\\ast}(T)\\,V^{a} $\n\n$\n\nW^{w} = \\max(\\delta,\\,-V^{w}xA),\\qquad W^{s} = \\max\\big(\\min(0,\\delta-W^{w}),\\,-V^{s}xA\\big) $\n\n$\n\nQv = Lv\\,W^{w} + L_s\\,W^{s} $\n\nInputs\n\nVs,Vw,Vv,Va,T: layer-local stores and temperature\nLv,Ls: latent constants (matching your model convention)\nxA: cap factor (like your XNPAX)\n\nOutputs\n\nWw corresponds to (W^{w}) (liquid exchange term)\nWs corresponds to (W^{s}) (snow/solid exchange term)\nQv corresponds to (Q_v) (latent energy term)\n\nIntended conservative application (matching your code’s sign convention):\n\nVs ← Vs + Ws\nVw ← Vw + Ww\nVv ← Vv - (Ws + Ww)\nEnergy increment +Qv\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.Freeze_Thaw!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.Freeze_Thaw!","text":"freeze_thaw!(Vs, Vw, Vi, Vv, T; cs, cw, ci, Tf, Lf, xX, ρi) -> (Wfs, Wfi, Qf)\n\nFreeze–thaw in a snow layer driven by thermal imbalance (ecosys-style).\n\nThis is a compact rewrite of your freeze–thaw block using short names.\n\nHeat capacity proxy: $ C^{\\ast}=csV^{s}+cw(V^{w}+V^{v})+c_iV^{i} $\n\nEnergy tendency: $ H1 = C^{\\ast}\\,(Tf - T)/2.7185\\cdot x_X $\n\nBranches (mirrors your code logic)\n\nIf (H_1 < 0): melting-like branch; partition among snow/ice by their fractions.\nElse: freezing-like branch; limited by available liquid.\n\nOutputs\n\nWfs (analog of your WFLFSX): snow/solid melt term (subtracted from (V^{s}) update)\nWfi (analog of your WFLFIX): liquid→ice term in water-equivalent units (ice update uses -Wfi/ρi)\nQf  (analog of your HFLF0X): latent energy term\n\nIntended application (aligned with your original update pattern):\n\nVs ← Vs - Wfs\nVw ← Vw + Wfs + Wfi\nVi ← Vi - Wfi/ρi\nEnergy increment +Qf\n\nNotes\n\nLf corresponds to the “333” coefficient used in your code’s internal unit system.\nxX corresponds to your XNPXX.\nρi corresponds to soil_iceDensty.\n\n\n\n\n\n","category":"function"},{"location":"AiECO_SnowCore/#Ace1.Snow_Mod.Snow_FluxEchg!","page":"AiECO_SnowCore","title":"Ace1.Snow_Mod.Snow_FluxEchg!","text":"Snow_FluxEchg!(Vs,Vw,Vi,Vv,T;\n           Vlyr, A,\n           Va, υ, C, dz,\n           Fs,Fw,Fi,Fv,Fh,\n           k,Dv,\n           cs,cw,ci,\n           Lv,Ls, Tf,Lf, ρi,\n           xA,xX,xY, dt,\n           sf,\n           bottom_cb=bottom_exchange!) -> bot\n\nOne conservative snow substep (finite-volume style).\n\nOrchestrates:\n\nlayer_props! (compute (V^{a},\\upsilon,C,\\Delta z))\nsurf_flux! (top boundary fluxes at (1/2))\nflux_internal! (internal interfaces (L+1/2))\nbottom_cb (bottom boundary (J+1/2))\nFlux divergence update\nOperator-split sources: vapor_relax! and freeze_thaw!\n\nCore update (flux divergence)\n\nFor any store (X\\in{V^{s},V^{w},V^{i},V^{v}}): $ XL^{n+1} = XL^{n}\n\n\n\n\\left(F^{X}{L-1/2} - F^{X}{L+1/2}\\right)\\,\\Delta t_s\n\nS_L^{X}\n\n$\n\nEnergy in (CT) form: $ (CT)L^{n+1} = (CT)L^{n}\n\n\n\n\\left(F^{h}{L-1/2} - F^{h}{L+1/2}\\right)\\,\\Delta t_s\n\nS_L^{E}\n\n$\n\nInputs\n\nState arrays (length (J)): Vs,Vw,Vi,Vv,T\nGeometry: Vlyr, A\nWork arrays (length (J)): Va,υ,C,dz\nInterface flux arrays (length (J+1)): Fs,Fw,Fi,Fv,Fh\nTransport props: k,Dv\nConstants: cs,cw,ci, Lv,Ls, Tf,Lf,ρi\nScaling factors:\nxA (like XNPAX) caps per-substep removals\nxX (like XNPXX) freeze–thaw scaling\nxY (like XNPYX) interface scaling (set 1.0 if unused)\nTime step: dt (this is your (\\Delta t_s) for the snow substep)\nsf (surface forcing NamedTuple) must include fields:\nSW, LW, epsσ, Tc, fc, Td, fd, Ta, υa, Ke, Kh, Ps, Pw, Pi, Qin, fs, θmin\n\nOutputs\n\nUpdates the state arrays in-place.\nReturns the NamedTuple from bottom_cb (so you can access partitioned diagnostics if you include them).\n\n\n\n\n\n","category":"function"},{"location":"EnergyFlux_Exchange_Soil/#Air–Residue-Soil-Energy-Water-Flux-Echange-Solver","page":"EnergyFluxExchangeSoil","title":"Air–Residue-Soil Energy Water Flux Echange Solver","text":"by Tongxi Hu (t.hu@colostate.edu)\n\njulia id=\"f8y9sq\" using Ace1","category":"section"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.AirState","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.AirState","text":"AirState(T_a, e_a)\n\nGround-air node just above the surface.\n\nUnits\n\nT_a [K]\ne_a : vapor variable (Pa if you keep default e_sat; otherwise your VP units)\n\nSymbol map\n\nT_a ↔ T_a\ne_a ↔ e_a (Vapor Concentration)\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.Conductances","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.Conductances","text":"Conductances(g_v_s, g_h_s, g_v_r, g_h_r, g_v_rs)\n\nTransfer conductances supplied by your aerodynamic/resistance scheme.\n\nFlux forms\n\nVapor: E = g_v * (e_a - e^*)\nSensible: H = g_h * (T_a - T)\n\nUnits\n\ng_v_* must convert a vapor-variable gradient to the same units as E (store per time).\ng_h_* must convert a temperature gradient to an energy flux (per time).\n\nField meanings\n\ng_v_s, g_h_s: air ↔ soil surface\ng_v_r, g_h_r: air ↔ residue surface\ng_v_rs: residue ↔ soil vapor coupling (optional; set 0.0 to disable)\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities","text":"HeatCapacities(C_s, C_r)\n\nAreal heat capacities for soil surface and residue nodes.\n\nUsage\n\nIf C_s > 0, Solve_Flux_Exchange_Kernel! may update T_s internally.\nIf C_r > 0, Solve_Flux_Exchange_Kernel! may update T_r internally.\nIf C_* <= 0, temperatures are not updated (flux-only mode).\n\nUnits Energy per area per Kelvin.\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing","text":"RadiationForcing(SW, LW_in, albedo, c_emit, c_can, c_dead, T_can, T_dead)\n\nRadiation and LW-exchange coefficients for a surface node.\n\nNet radiation form used\n\nR_n(T) = (1-alpha)*SW + LW_in - c_emit*T^4 + c_can*(T_can^4 - T^4) + c_dead(T_dead^4 - T^4)\n\nNotes\n\nEmitted LW is c_emit*T^4\nCanopy/Dead exchange is proportional to (T_source^4 - T^4) with canopy factors folded into c_can, c_dead.\n\nUnits All radiation terms must be (W m⁻²).\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.ResidueState","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.ResidueState","text":"ResidueState(T_r, psi_r, W_r)\n\nResidue/litter surface node (optional).\n\nUnits\n\nSame conventions as soil surface:\n\nT_r (K)\npsi_r (MPa)\nW_r residue water store used to limit evaporation\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState","text":"SoilSurfaceState(T_s, psi_s, W_s)\n\nSoil surface node.\n\nUnits\n\nT_s (K)\npsi_s (MPa) \nW_s : available surface water store used to limit evaporation over a step\n\nNotes\n\nW_s only needs to be consistent with the limiter in vapor_flux_limited.\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes","text":"SurfaceFluxes()\n\nContainer of mean fluxes over the time step (or mean over substeps).\n\nSoil-surface fluxes\n\nRn_s: net radiation\nH_s: sensible heat\nLE_s: latent heat (lambda E_s)\nJh_s: enthalpy advected with mass flux (E_s c_pw T_src)\nE_s: vapor mass flux (negative = evaporation)\n\nResidue fluxes\n\nAnalogous fields Rn_r, H_r, LE_r, Jh_r, E_r.\n\nResidue–soil exchange\n\nQ_rs: conductive heat exchange (+ if residue warmer than soil)\nFv_rs: vapor exchange (+ if residue vapor variable > soil)\nJh_rs: enthalpy with Fv_rs\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling","text":"ThermalCoupling(G_rs_base, use_free_convection, g,beta,nu,alpha,θ,θcrit,Ra_max)\n\n### Residue-soil conductive coupling:\n$$\nQ_{rs} = G_{rs} * (T_r - T_s)\n$$\n\n### Optional enhancement: \n$$\nG_{rs} = G_{rs,base} \\cdot Nu(Ra,Pr)\n$$\n\nSet `use_free_convection=false` to use `G_rs_base` directly.\n\n\n\n\n\n","category":"type"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.Solve_Flux_Exchange_Kernel!-Tuple{AirState, SoilSurfaceState, Union{Nothing, ResidueState}, Conductances, RadiationForcing, RadiationForcing, HeatCapacities, ThermalCoupling}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.Solve_Flux_Exchange_Kernel!","text":"Solve_Flux_Exchange_Kernel!(air, soil, residue, cond, rad_s, rad_r, hc, tc;\n            dt, λ, c_pw, C_kelvin=18/R, snow_free=1.0, litter_cover=1.0, nsub=10)\n\nAdvance one time step of the coupled system.\n\nMethods equations (core)\n\nKelvin equilibrium: e^*(Tpsi) = e_sat(T)expleft(C_kelvinfracpsiTright)\nVapor flux (limited): E = g_v(e_a - e^*)qquad Ege -fracWDelta t\nHeat fluxes: H = g_h(T_a - T)quad LE=lambda Equad J_h = E c_pw T_src\nNet radiation: R_n(T) = (1-alpha)SW + LW_in - c_emitT^4 + c_can(T_can^4-T^4)+c_dead(T_dead^4-T^4)\nResidue–soil conduction (if residue present):Q_rs = G_rs(T_r - T_s)\n\nWhat this function updates\n\nAlways updates water stores soil.W_s and (if present) residue.W_r.\nUpdates temperatures only when corresponding heat capacity is positive:\nif hc.C_s > 0: updates soil.T_s\nif hc.C_r > 0: updates residue.T_r\n\nOptions\n\nsnow_free, litter_cover are multiplicative masks on surface fluxes.\nnsub substeps are used when residue is present for numerical stability.\nC_kelvin default 18/R assumes ψ in MPa (ecosys-consistent).\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu-Tuple{Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu","text":"dnusselt_churchill_chu(Pr) -> denom\n\nChurchill–Chu denominator term: $ \\left(1 + (0.492/Pr)^{9/16}\\right)^{4/9} $\n\nUsed in the classic natural-convection correlation for Nu(RaPr).\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin-Tuple{Float64, Float64, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin","text":"e_eq_kelvin(TK, psi; C_kelvin) -> e_star\n\nKelvin-corrected equilibrium vapor variable at a surface.\n\nEquation\n\ne^*(Tpsi) = e_sat(T)expleft(C_kelvinfracpsiTright)\n\nChoosing C_kelvin (unit-critical)\n\n(ψ in MPa):   C_kelvin = frac18R   Where 18 arises from V_wtimes(10^6textPaMPa).\nstrict SI choice (ψ in Pa):   Use C_kelvin = V_wR   with V_wapprox 18times10^-6 m³ mol⁻¹ and ψ in Pa.\n\nUnits\n\nTK (K)\npsi (MPa)  \nOutput has the same units as e_sat(T) and air.e_a \n\nPhysical meaning\n\nAs soil/residue dries, ψ becomes more negative → e^* decreases → evaporation is suppressed.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.e_sat-Tuple{Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.e_sat","text":"e_sat(TK) -> e_sat\n\nSaturated vapor pressure (Pa) at temperature T_K (K).\n\nDefault behavior\n\nand your conductance g_v is consistent with those units.\n\nUnits\n\nInput: TK (K)\nOutput: vapor pressure (Pa)\n\nNotes\n\nOnly consistency matters for the bulk-gradient flux: E = g_v * (e_a - e^*)\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs-Tuple{Float64, Float64, ThermalCoupling}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs","text":"effective_G_rs($T_r, $T_s, tc) -> $G_rs\n\nEffective residue–soil conductance, optionally enhanced by free convection.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux-NTuple{4, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux","text":"enthalpy_flux(E, c_pw, T_surface, T_air) -> Jh\n\nEnthalpy flux carried with the water mass transfer.\n\nEquation:  $ Jh = E\\,c{p,w}\\,T_{src} $\n\nSource temperature convention\n\nIf E < 0 (evaporation; mass leaves surface), use T_surface\nIf E > 0 (condensation; mass arrives from air), use T_air\n\nThis separates “advected sensible heat with mass transfer” from latent heat lambda E.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.net_radiation-Tuple{Float64, RadiationForcing}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.net_radiation","text":"net_radiation(T, rad) -> Rn\n\nCompute net radiation R_n(T) for a surface. See RadiationForcing for the exact equation.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu-Tuple{Float64, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu","text":"nusselt_churchill_chu(Ra, Pr) -> Nu\n\nNatural convection correlation (Churchill–Chu style), clamped to Nuge 1: $ Nu = \\max\\left(1,\\;0.68 + \\frac{0.67\\,Ra^{1/4}}{\\left(1 + (0.492/Pr)^{9/16}\\right)^{4/9}}\\right) $\n\nInterpretation: Nu=1 is pure conduction; Nu1 enhances effective transport.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.prandtl-Tuple{Float64, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.prandtl","text":"prandtl(nu, alpha) -> Pr\n\nPrandtl number: $ Pr = \\frac{\\nu}{\\alpha} $\n\nnu\n: kinematic viscosity (momentum diffusivity)\nalpha\n: thermal diffusivity\n\nInterpretation: compares momentum diffusion to heat diffusion.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous-Tuple{Float64, Float64, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous","text":"rayleigh_porous(ΔT, θ, θcrit; g,beta,nu,alpha,Ra_max) -> Ra\n\nEffective Rayleigh number in a porous phase using a connectivity proxy.\n\nProxy length scale: L_eff^3 = max(0theta - theta_crit)^3\nRayleigh number:Ra = minleft(Ra_maxfracgbetanualphaDelta TL_eff^3right)\n\nConvection “turns on” only when a phase (air or water) is sufficiently connected above a threshold.\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor-NTuple{4, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor","text":"rayleigh_prefactor(g, beta, nu, alpha) -> pref\n\nRayleigh prefactor: $ \\text{pref} = \\frac{g\\,\\beta}{\\nu\\,\\alpha} $\n\nSo a Rayleigh number can be formed as: $ Ra = \\text{pref}\\,(\\Delta T\\, L^3) $\n\nThis appears naturally when nondimensionalizing the Navier–Stokes + heat equation under the Boussinesq approximation (buoyancy-driven flow).\n\n\n\n\n\n","category":"method"},{"location":"EnergyFlux_Exchange_Soil/#Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited-NTuple{5, Float64}","page":"EnergyFluxExchangeSoil","title":"Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited","text":"vapor_flux_limited(g_v, e_air, e_eq, W_available, dt) -> E\n\nCompute vapor mass flux with an availability limiter.\n\nBase flux: E = g_v * (e_air - e^*)\n\nLimiter (prevents over-evaporation): E ge -fracWDelta t\n\nSign\n\nE < 0 : evaporation (surface loses water)\nE > 0 : condensation (surface gains water)\n\nW_available is the surface store used only to enforce this bound.\n\n\n\n\n\n","category":"method"},{"location":"#AiECO","page":"Home","title":"AiECO","text":"Tongxi Hu (T.Hu@colostate.edu) Documentation generated from docstrings using Documenter.jl.","category":"section"},{"location":"WaterFlux_Exchange_Soil/#Capillary-Water-Exchange:-Litter-Soil","page":"WaterFluxExchangeSoil","title":"Capillary Water Exchange: Litter <-> Soil","text":"","category":"section"},{"location":"WaterFlux_Exchange_Soil/#Ace1.Water_Mod.MCM","page":"WaterFluxExchangeSoil","title":"Ace1.Water_Mod.MCM","text":"Fields:\n\nθ_FC : water content at field capacity\nϕ_FC : matric potential at field capacity (negative)\nθ_WP : water content at wilting point\nϕ_WP : matric potential at wilting point (negative)\nϕ    : porosity\nSRP  : shape parameter\n\n\n\n\n\n","category":"type"}]
}
