var documenterSearchIndex = {"docs":
[{"location":"surface/#Air–Soil–Residue-Surface-Solver","page":"Surface","title":"Air–Soil–Residue Surface Solver","text":"julia id=\"f8y9sq\" using Ace1","category":"section"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.AirState","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.AirState","text":"AirState(T_a, e_a)\n\nGround-air node just above the surface.\n\nUnits\n\nT_a [K]\ne_a : vapor variable (Pa if you keep default e_sat; otherwise your VP units)\n\nSymbol map\n\nT_a ↔ T_a\ne_a ↔ e_a (or VP_a if using ecosys VP variable)\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.Conductances","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.Conductances","text":"Conductances(g_v_s, g_h_s, g_v_r, g_h_r, g_v_rs)\n\nTransfer conductances supplied by your aerodynamic/resistance scheme.\n\nFlux forms\n\nVapor:\n\n$\n\nE = gv (ea - e^*) $\n\nSensible:\n\n$\n\nH = gh (Ta - T) $\n\nUnits\n\ng_v_* must convert a vapor-variable gradient to the same units as E (store per time).\ng_h_* must convert a temperature gradient to an energy flux (per time).\n\nField meanings\n\ng_v_s, g_h_s: air ↔ soil surface\ng_v_r, g_h_r: air ↔ residue surface\ng_v_rs: residue ↔ soil vapor coupling (optional; set 0.0 to disable)\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities","text":"HeatCapacities(C_s, C_r)\n\nAreal heat capacities for soil surface and residue nodes.\n\nUsage\n\nIf C_s > 0, step_surface! may update T_s internally.\nIf C_r > 0, step_surface! may update T_r internally.\nIf C_* <= 0, temperatures are not updated (flux-only mode).\n\nUnits\n\nEnergy per area per Kelvin (or your model-scaled equivalent).\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing","text":"RadiationForcing(SW, LW_in, albedo, c_emit, c_can, c_dead, T_can, T_dead)\n\nRadiation and LW-exchange coefficients for a surface node.\n\nNet radiation form used\n\n$\n\nRn(T) = (1-\\alpha)SW + LW{in}\n\nc_{emit}T^4\nc{can}(T{can}^4 - T^4)\nc{dead}(T{dead}^4 - T^4)\n\n$\n\nNotes\n\nThis matches your ecosys-style implementation where emitted LW is c_emit*T^4 and canopy/dead exchange is proportional to (T_source^4 - T^4) with view/cover factors folded into c_can, c_dead.\n\nUnits\n\nAll radiation terms must be consistent with your energy accounting (W m⁻² or model-scaled).\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.ResidueState","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.ResidueState","text":"ResidueState(T_r, psi_r, W_r)\n\nResidue/litter surface node (optional).\n\nUnits\n\nSame conventions as soil surface:\n\nT_r (K)\npsi_r (MPa)\nW_r residue water store used to limit evaporation\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState","text":"SoilSurfaceState(T_s, psi_s, W_s)\n\nSoil surface node.\n\nUnits\n\nT_s (K)\npsi_s (MPa) (recommended; consistent with ecosys Kelvin factor default)\nW_s : available surface water store used to limit evaporation over a step\n\nNotes\n\nW_s only needs to be consistent with the limiter in vapor_flux_limited. If your legacy limiter is E ≥ -W_s * XNPXX, then your effective dt is 1/XNPXX.\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes","text":"SurfaceFluxes()\n\nContainer of mean fluxes over the time step (or mean over substeps).\n\nSoil-surface fluxes\n\nRn_s: net radiation\nH_s: sensible heat\nLE_s: latent heat (lambda E_s)\nJh_s: enthalpy advected with mass flux (E_s c_pw T_src)\nE_s: vapor mass flux (negative = evaporation)\n\nResidue fluxes\n\nAnalogous fields Rn_r, H_r, LE_r, Jh_r, E_r.\n\nResidue–soil exchange\n\nQ_rs: conductive heat exchange (+ if residue warmer than soil)\nFv_rs: vapor exchange (+ if residue vapor variable > soil)\nJh_rs: enthalpy with Fv_rs\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling","text":"ThermalCoupling(G_rs_base, use_free_convection, g,beta,nu,alpha,θ,θcrit,Ra_max)\n\nResidue–soil conductive coupling: $ Q{rs} = G{rs}(Tr - Ts) $\n\nOptional enhancement: $ G{rs} = G{rs,base} \\cdot Nu(Ra,Pr) $\n\nSet use_free_convection=false to use G_rs_base directly.\n\n\n\n\n\n","category":"type"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu-Tuple{Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu","text":"dnusselt_churchill_chu(Pr) -> denom\n\nChurchill–Chu denominator term: $ \\left(1 + (0.492/Pr)^{9/16}\\right)^{4/9} $\n\nUsed in the classic natural-convection correlation for Nu(RaPr).\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin-Tuple{Float64, Float64, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin","text":"e_eq_kelvin(TK, psi; C_kelvin) -> e_star\n\nKelvin-corrected equilibrium vapor variable at a surface.\n\nEquation\n\n$\n\ne^*(T,\\psi) = e{sat}(T)\\exp\\left(C{kelvin}\\frac{\\psi}{T}\\right) $\n\nChoosing C_kelvin (unit-critical)\n\necosys-consistent choice (ψ in MPa):\n\n$\n\nC{kelvin} = \\frac{18}{R} $ because 18 arises from Vw\\times(10^6\\,\\text{Pa/MPa})$.\n\nstrict SI choice (ψ in Pa):\n\nUse C_kelvin = V_wR with V_wapprox 18times10^-6 m³ mol⁻¹ and ψ in Pa.\n\nUnits\n\nTK [K]\npsi [MPa] if you keep default C_kelvin = 18/R (recommended for your ecosys port)\nOutput has the same units as e_sat(T) and air.e_a (Pa by default; VP units if you swap e_sat)\n\nPhysical meaning\n\nAs soil/residue dries, ψ becomes more negative → e^* decreases → evaporation is suppressed.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.e_sat-Tuple{Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.e_sat","text":"e_sat(TK) -> e_sat\n\nSaturation value of the vapor variable at temperature TK [K].\n\nDefault behavior\n\nThis default implementation returns saturation vapor pressure in Pa using a common empirical form.\n\nIf your model uses the ecosys-style VP variable (not Pa)\n\nReplace this function with your cal_Saturated_VP(T) (or wrap it) so that:\n\ne_sat(T) returns the same VP units as air.e_a,\nand your conductance g_v is consistent with those units.\n\nUnits\n\nInput: TK [K]\nOutput: vapor variable (Pa by default; otherwise your VP units)\n\nNotes\n\nOnly consistency matters for the bulk-gradient flux: $ E = gv (ea - e^*) $\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs-Tuple{Float64, Float64, Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs","text":"effective_G_rs(T_r, T_s, tc) -> G_rs\n\nEffective residue–soil conductance, optionally enhanced by free convection.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux-NTuple{4, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux","text":"enthalpy_flux(E, c_pw, T_surface, T_air) -> Jh\n\nEnthalpy flux carried with the water mass transfer.\n\nEquation\n\n$\n\nJh = E\\,c{p,w}\\,T_{src} $\n\nSource temperature convention\n\nIf E < 0 (evaporation; mass leaves surface), use T_surface\nIf E > 0 (condensation; mass arrives from air), use T_air\n\nThis separates “advected sensible heat with mass transfer” from latent heat lambda E.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.net_radiation-Tuple{Float64, Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.net_radiation","text":"net_radiation(T, rad) -> Rn\n\nCompute net radiation R_n(T) for a surface. See RadiationForcing for the exact equation.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu-Tuple{Float64, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu","text":"nusselt_churchill_chu(Ra, Pr) -> Nu\n\nNatural convection correlation (Churchill–Chu style), clamped to Nuge 1: $ Nu = \\max\\left(1,\\;0.68 + \\frac{0.67\\,Ra^{1/4}}{\\left(1 + (0.492/Pr)^{9/16}\\right)^{4/9}}\\right) $\n\nInterpretation: Nu=1 is pure conduction; Nu1 enhances effective transport.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous-Tuple{Float64, Float64, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous","text":"rayleigh_porous(ΔT, θ, θcrit; g,beta,nu,alpha,Ra_max) -> Ra\n\nEffective Rayleigh number in a porous phase using a connectivity proxy.\n\nProxy length scale\n\n$\n\nL{eff}^3 := \\max(0,\\theta - \\theta{crit})^3 $\n\nRayleigh number\n\n$\n\nRa = \\min\\left(Ra{max},\\;\\frac{g\\beta}{\\nu\\alpha}\\,|\\Delta T|\\,L{eff}^3\\right) $\n\nThis mimics the legacy ecosys-style behavior where convection “turns on” only when a phase (air or water) is sufficiently connected above a threshold.\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor-NTuple{4, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor","text":"rayleigh_prefactor(g, beta, nu, alpha) -> pref\n\nRayleigh prefactor: $ \\text{pref} = \\frac{g\\,\\beta}{\\nu\\,\\alpha} $\n\nSo a Rayleigh number can be formed as: $ Ra = \\text{pref}\\,(\\Delta T\\,L^3) $\n\nThis appears naturally when nondimensionalizing the Navier–Stokes + heat equation under the Boussinesq approximation (buoyancy-driven flow).\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.step_surface!-Tuple{Ace1.Solve_WaterEnergy_AirSoil.AirState, Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState, Union{Nothing, Ace1.Solve_WaterEnergy_AirSoil.ResidueState}, Ace1.Solve_WaterEnergy_AirSoil.Conductances, Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing, Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing, Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities, Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.step_surface!","text":"step_surface!(air, soil, residue, cond, rad_s, rad_r, hc, tc;\n            dt, λ, c_pw, C_kelvin=18/R, snow_free=1.0, litter_cover=1.0, nsub=10)\n\nAdvance one time step of the coupled system.\n\nMethods equations (core)\n\nKelvin equilibrium: $ e^*(T,\\psi) = e{sat}(T)\\exp\\left(C{kelvin}\\frac{\\psi}{T}\\right) $\n\nVapor flux (limited): $ E = gv(ea - e^*),\\qquad E\\ge -\\frac{W}{\\Delta t} $\n\nHeat fluxes: $ H = gh(Ta - T),\\quad LE=\\lambda E,\\quad Jh = E c{p,w} T_{src} $\n\nNet radiation: $ Rn(T) = (1-\\alpha)SW + LW{in} - c{emit}T^4 + c{can}(T{can}^4-T^4)+c{dead}(T_{dead}^4-T^4) $\n\nResidue–soil conduction (if residue present): $ Q{rs} = G{rs}(Tr - Ts) $\n\nWhat this function updates\n\nAlways updates water stores soil.W_s and (if present) residue.W_r.\nUpdates temperatures only when corresponding heat capacity is positive:\nif hc.C_s > 0: updates soil.T_s\nif hc.C_r > 0: updates residue.T_r\n\nOptions\n\nsnow_free, litter_cover are multiplicative masks on surface fluxes.\nnsub substeps are used when residue is present for numerical stability.\nC_kelvin default 18/R assumes ψ in MPa (ecosys-consistent).\n\n\n\n\n\n","category":"method"},{"location":"surface/#Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited-NTuple{5, Float64}","page":"Surface","title":"Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited","text":"vapor_flux_limited(g_v, e_air, e_eq, W_available, dt) -> E\n\nCompute vapor mass flux with an availability limiter.\n\nBase flux\n\n$\n\nE = gv (e{air} - e^*) $\n\nLimiter (prevents over-evaporation)\n\n$\n\nE \\ge -\\frac{W}{\\Delta t} $\n\nSign\n\nE < 0 : evaporation (surface loses water)\nE > 0 : condensation (surface gains water)\n\nW_available is the surface store used only to enforce this bound.\n\n\n\n\n\n","category":"method"},{"location":"#Ace1.jl","page":"Home","title":"Ace1.jl","text":"Documentation generated from docstrings using Documenter.jl.","category":"section"}]
}
