<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AiECO Soil Water Core · AiECO.jl</title><meta name="title" content="AiECO Soil Water Core · AiECO.jl"/><meta property="og:title" content="AiECO Soil Water Core · AiECO.jl"/><meta property="twitter:title" content="AiECO Soil Water Core · AiECO.jl"/><meta name="description" content="Documentation for AiECO.jl."/><meta property="og:description" content="Documentation for AiECO.jl."/><meta property="twitter:description" content="Documentation for AiECO.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AiECO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../EnergyFlux_Exchange_Soil/">AiECO Soil Energy Core</a></li><li class="is-active"><a class="tocitem" href>AiECO Soil Water Core</a><ul class="internal"><li><a class="tocitem" href="#Core-Equations"><span>Core Equations</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../AiECO_SnowCore/">AiECO Snow Core</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>AiECO Soil Water Core</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AiECO Soil Water Core</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hutx2309/Ace1.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hutx2309/Ace1.jl/blob/main/docs/src/WaterFlux_Exchange_Soil.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="AiECO-Capillary-Water-Exchange:-Litter-Soil"><a class="docs-heading-anchor" href="#AiECO-Capillary-Water-Exchange:-Litter-Soil">AiECO Capillary Water Exchange: Litter &lt;-&gt; Soil</a><a id="AiECO-Capillary-Water-Exchange:-Litter-Soil-1"></a><a class="docs-heading-anchor-permalink" href="#AiECO-Capillary-Water-Exchange:-Litter-Soil" title="Permalink"></a></h1><p>This page summarizes the governing equations used by <code>Ace1.Water_Mod.capillary_litt_soil_exchange!</code>.</p><h2 id="Core-Equations"><a class="docs-heading-anchor" href="#Core-Equations">Core Equations</a><a id="Core-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Equations" title="Permalink"></a></h2><h3 id="1)-Volumetric-Water-Content"><a class="docs-heading-anchor" href="#1)-Volumetric-Water-Content">1) Volumetric Water Content</a><a id="1)-Volumetric-Water-Content-1"></a><a class="docs-heading-anchor-permalink" href="#1)-Volumetric-Water-Content" title="Permalink"></a></h3><p class="math-container">\[\theta^\ell =
\begin{cases}
\dfrac{\min(C_\ell, V_\ell)}{V_{dry,\ell}}, &amp; V_{dry,\ell} &gt; \varepsilon \\
\phi_\ell, &amp; \text{otherwise}
\end{cases}\]</p><p class="math-container">\[\theta^s = \mathrm{clamp}\!\left(\dfrac{V_s}{V_{soil}}, \theta_{min,s}, \phi_s\right)\]</p><h3 id="2)-Matric-and-Total-Potential"><a class="docs-heading-anchor" href="#2)-Matric-and-Total-Potential">2) Matric and Total Potential</a><a id="2)-Matric-and-Total-Potential-1"></a><a class="docs-heading-anchor-permalink" href="#2)-Matric-and-Total-Potential" title="Permalink"></a></h3><p class="math-container">\[(\psi_m^\ell, \theta^\ell) = \mathrm{MCM}(\theta^\ell), \qquad
(\psi_m^s, \theta^s) = \mathrm{MCM}(\theta^s)\]</p><p class="math-container">\[\psi^\ell = \psi_m^\ell + \psi_g^\ell + \psi_o^\ell, \qquad
\psi^s = \psi_m^s + \psi_g^s + \psi_o^s\]</p><h3 id="3)-Conductance-and-Raw-Flux"><a class="docs-heading-anchor" href="#3)-Conductance-and-Raw-Flux">3) Conductance and Raw Flux</a><a id="3)-Conductance-and-Raw-Flux-1"></a><a class="docs-heading-anchor-permalink" href="#3)-Conductance-and-Raw-Flux" title="Permalink"></a></h3><p class="math-container">\[G = \frac{2 k^\ell k^s}{k^\ell L_s + k^s L_\ell}, \qquad
F_{raw} = G(\psi^\ell - \psi^s) A f_{wet} \Delta \tau_\psi\]</p><h3 id="4)-Bounded-Realized-Flux"><a class="docs-heading-anchor" href="#4)-Bounded-Realized-Flux">4) Bounded Realized Flux</a><a id="4)-Bounded-Realized-Flux-1"></a><a class="docs-heading-anchor-permalink" href="#4)-Bounded-Realized-Flux" title="Permalink"></a></h3><p class="math-container">\[V_{air,s} = \max(0,\;V_{cap,s} - V_s - V_{ice,s}), \qquad
V_{cap,\ell}^{rem} = \max(0,\;C_\ell - V_\ell)\]</p><p>Litter to soil (<code>Fraw &gt;= 0</code>):</p><p class="math-container">\[F = \max\!\left(0,\;\min(F_{corr}, V_\ell \Delta\tau_v, V_{air,s})\right)\]</p><p>Soil to litter (<code>Fraw &lt; 0</code>):</p><p class="math-container">\[F = \min\!\left(0,\;\max(F_{corr}, -V_s \Delta\tau_v, -V_{cap,\ell}^{rem})\right)\]</p><h3 id="5)-Advected-Heat"><a class="docs-heading-anchor" href="#5)-Advected-Heat">5) Advected Heat</a><a id="5)-Advected-Heat-1"></a><a class="docs-heading-anchor-permalink" href="#5)-Advected-Heat" title="Permalink"></a></h3><p class="math-container">\[H = c_{pw} T_{src} F, \qquad
T_{src} =
\begin{cases}
T_\ell, &amp; F &gt; 0 \\
T_s, &amp; F \le 0
\end{cases}\]</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Ace1.Water_Mod.MCM"><a class="docstring-binding" href="#Ace1.Water_Mod.MCM"><code>Ace1.Water_Mod.MCM</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Fields:</p><ul><li><code>θ_FC</code> : water content at field capacity</li><li><code>ϕ_FC</code> : matric potential at field capacity (negative)</li><li><code>θ_WP</code> : water content at wilting point</li><li><code>ϕ_WP</code> : matric potential at wilting point (negative)</li><li><code>ϕ</code>    : porosity</li><li><code>SRP</code>  : shape parameter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/c0a263b763345f4dafc42292e443fa5c7ffb26b0/src/water/Capillary_Litt_Soil_Exchg.jl#L2-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Water_Mod.capillary_litt_soil_exchange!-Tuple{Base.RefValue{Float64}, Base.RefValue{Float64}}"><a class="docstring-binding" href="#Ace1.Water_Mod.capillary_litt_soil_exchange!-Tuple{Base.RefValue{Float64}, Base.RefValue{Float64}}"><code>Ace1.Water_Mod.capillary_litt_soil_exchange!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">capillary_litt_soil_exchange!(Vℓ::Ref{Float64}, Vₛ::Ref{Float64}; kwargs...) -&gt; (F̄, H̄)</code></pre><p>Liquid-phase capillary exchange between litter micropore water (ℓ) and soil micropore water (s).</p><p><strong>State and geometry</strong></p><p>Storages (volumes):</p><ul><li><code>Vℓ</code> : litter liquid volume</li><li><code>Vₛ</code> : soil liquid volume</li></ul><p>Conversions to volumetric water content:</p><ul><li><code>Vdryℓ</code> : litter dry volume</li><li><code>Vsoil</code> : soil volume</li></ul><p>Porosities:</p><ul><li><code>ϕℓ</code>, <code>ϕₛ</code></li></ul><p><strong>Potentials and flux</strong></p><p>Volumetric water contents:</p><p class="math-container">\[\theta^{\ell}=
\begin{cases}
\dfrac{\min(C_{\ell},V_{\ell})}{V_{dry,\ell}}, &amp; V_{dry,\ell}&gt;\varepsilon\\
\phi_{\ell}, &amp; \text{otherwise}
\end{cases}
\qquad
\theta^{s}=\mathrm{clamp}\!\left(\dfrac{V_{s}}{V_{soil}},\theta_{min,s},\phi_{s}\right)\]</p><p>Matric potentials from MCM (your function):</p><p class="math-container">\[(\psi_m^{\ell},\theta^{\ell})=\mathrm{MCM}(\theta^{\ell}),\qquad
(\psi_m^{s},\theta^{s})=\mathrm{MCM}(\theta^{s})\]</p><p>Total potentials:</p><p class="math-container">\[\psi^{\ell}=\psi_m^{\ell}+\psi_g^{\ell}+\psi_o^{\ell},\qquad
\psi^{s}=\psi_m^{s}+\psi_g^{s}+\psi_o^{s}\]</p><p>Conductance and raw Darcy-like flux:</p><p class="math-container">\[G=\frac{2k^{\ell}k^{s}}{k^{\ell}L_s+k^{s}L_{\ell}},
\qquad
F_{raw}=G(\psi^{\ell}-\psi^{s})A f_{wet}\Delta\tau_{\psi}\]</p><p>Air-entry correction is applied in code using <code>θaeℓ</code> and <code>θaeₛ</code> (same structure as ecosys).</p><p><strong>Bounds (mass + capacity)</strong></p><p>Define receiving pore space in soil:</p><p class="math-container">\[V_{air,s}=\max(0,\;V_{cap,s}-V_{s}-V_{ice,s})\]</p><p>and remaining litter capacity:</p><p class="math-container">\[V_{cap,\ell}=\max(0,\;C_{\ell}-V_{\ell})\]</p><p>Then the realized flux is bounded as:</p><ul><li>If <code>Fraw ≥ 0</code> (ℓ→s):</li></ul><p class="math-container">\[F=\max\big(0,\min(F_{corr},V_{\ell}\Delta\tau_v,V_{air,s})\big)\]</p><ul><li>If <code>Fraw &lt; 0</code> (s→ℓ):</li></ul><p class="math-container">\[F=\min\big(0,\max(F_{corr},-V_{s}\Delta\tau_v,-V_{cap,\ell})\big)\]</p><p><strong>Heat advection</strong></p><p>Advected sensible heat uses the source temperature:</p><p class="math-container">\[H=c_{pw}T_{src}F,\quad
T_{src}=\begin{cases}
T_{\ell},&amp;F&gt;0\\
T_{s},&amp;F\le 0
\end{cases}\]</p><p><strong>Return and mutation</strong></p><p>Returns <code>(F̄, H̄)</code> accumulated over <code>nsub</code> internal substeps and updates the storages:</p><p class="math-container">\[V_{\ell}\leftarrow V_{\ell}-F,\qquad
V_{s}\leftarrow V_{s}+F.\]</p><p><strong>Required inputs (keywords)</strong></p><ul><li><code>Cℓ, Vdryℓ, Vsoil, ϕℓ, ϕₛ, θminₛ</code></li><li><code>θaeℓ, θaeₛ</code></li><li><code>ψgℓ, ψoℓ, ψgₛ, ψoₛ</code></li><li><code>kℓ[1:100], kₛ[1:100]</code> (conductivity tables)</li><li><code>Lₛ, Lℓ, A, fwet</code></li><li><code>Δτψ, Δτv, nsub</code></li><li><code>c_pw, Tℓ, Tₛ</code></li><li><code>Vcapₛ, Viceₛ</code></li><li><code>pℓ::MCM, pₛ::MCM</code> (MCM parameter bundles)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/c0a263b763345f4dafc42292e443fa5c7ffb26b0/src/water/Capillary_Litt_Soil_Exchg.jl#L25-L132">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../EnergyFlux_Exchange_Soil/">« AiECO Soil Energy Core</a><a class="docs-footer-nextpage" href="../AiECO_SnowCore/">AiECO Snow Core »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 28 February 2026 00:31">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
