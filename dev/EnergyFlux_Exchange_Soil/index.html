<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EnergyFluxExchangeSoil · Ace1.jl</title><meta name="title" content="EnergyFluxExchangeSoil · Ace1.jl"/><meta property="og:title" content="EnergyFluxExchangeSoil · Ace1.jl"/><meta property="twitter:title" content="EnergyFluxExchangeSoil · Ace1.jl"/><meta name="description" content="Documentation for Ace1.jl."/><meta property="og:description" content="Documentation for Ace1.jl."/><meta property="twitter:description" content="Documentation for Ace1.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Ace1.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>EnergyFlux<em>Exchange</em>Soil</a></li><li><a class="tocitem" href="../WaterFlux_Exchange_Soil/">WaterFlux<em>Exchange</em>Soil</a></li><li><a class="tocitem" href="../AiECO_SnowCore/">AiECO_SnowCore</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>EnergyFlux<em>Exchange</em>Soil</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EnergyFlux<em>Exchange</em>Soil</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hutx2309/Ace1.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hutx2309/Ace1.jl/blob/main/docs/src/EnergyFlux_Exchange_Soil.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Air–Residue-Soil-Energy-Water-Flux-Echange-Solver"><a class="docs-heading-anchor" href="#Air–Residue-Soil-Energy-Water-Flux-Echange-Solver">Air–Residue-Soil Energy Water Flux Echange Solver</a><a id="Air–Residue-Soil-Energy-Water-Flux-Echange-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Air–Residue-Soil-Energy-Water-Flux-Echange-Solver" title="Permalink"></a></h1><p>by Tongxi Hu (t.hu@colostate.edu)</p><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.AirState"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.AirState"><code>Ace1.Solve_WaterEnergy_AirSoil.AirState</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AirState(T_a, e_a)</code></pre><p>Ground-air node just above the surface.</p><p><strong>Units</strong></p><ul><li><code>T_a</code> [K]</li><li><code>e_a</code> : <strong>vapor variable</strong> (Pa if you keep default <code>e_sat</code>; otherwise your VP units)</li></ul><p><strong>Symbol map</strong></p><ul><li><code>T_a</code> ↔ <code>T_a</code></li><li><code>e_a</code> ↔ <code>e_a</code> (vapor concentration)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L201-L213">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.Conductances"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.Conductances"><code>Ace1.Solve_WaterEnergy_AirSoil.Conductances</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Conductances(g_v_s, g_h_s, g_v_r, g_h_r, g_v_rs)</code></pre><p>Transfer conductances supplied by your aerodynamic/resistance scheme.</p><p>Flux forms</p><p class="math-container">\[E = g_v (e_a - e^*)\]</p><p class="math-container">\[H = g_h (T_a - T)\]</p><p>Units</p><ul><li><code>g_v_*</code> must convert a vapor-variable gradient to the same units as <code>E</code> (store per time).</li><li><code>g_h_*</code> must convert a temperature gradient to an energy flux (per time).</li></ul><p>Field meanings</p><ul><li><code>g_v_s</code>, <code>g_h_s</code>: air ↔ soil surface</li><li><code>g_v_r</code>, <code>g_h_r</code>: air ↔ residue surface</li><li><code>g_v_rs</code>: residue ↔ soil vapor coupling (optional; set <code>0.0</code> to disable)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L255-L276">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities"><code>Ace1.Solve_WaterEnergy_AirSoil.HeatCapacities</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HeatCapacities(C_s, C_r)</code></pre><p>Areal heat capacities for soil surface and residue nodes.</p><p>Usage</p><ul><li>If <code>C_s &gt; 0</code>, <code>Solve_Flux_Exchange_Kernel!</code> may update <code>T_s</code> internally.</li><li>If <code>C_r &gt; 0</code>, <code>Solve_Flux_Exchange_Kernel!</code> may update <code>T_r</code> internally.</li><li>If <code>C_* &lt;= 0</code>, temperatures are <strong>not updated</strong> (flux-only mode).</li></ul><p>Units Energy per area per Kelvin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L333-L345">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing"><code>Ace1.Solve_WaterEnergy_AirSoil.RadiationForcing</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RadiationForcing(SW, LW_in, albedo, c_emit, c_can, c_dead, T_can, T_dead)</code></pre><p>Radiation and LW-exchange coefficients for a surface node.</p><p><strong>Net radiation form used</strong></p><p class="math-container">\[R_n(T) = (1-\alpha)SW + LW_{in} - c_{emit}T^4
         + c_{can}(T_{can}^4 - T^4) + c_{dead}(T_{dead}^4 - T^4)\]</p><p><strong>Notes</strong></p><p class="math-container">\[\text{Emitted LW} = c_{emit}T^4\]</p><p class="math-container">\[\text{Canopy/Dead exchange} \propto (T_{source}^4 - T^4)\]</p><p>with canopy factors folded into <code>c_can</code> and <code>c_dead</code>.</p><p>Units All radiation terms must be (W m⁻²).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L285-L307">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.ResidueState"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.ResidueState"><code>Ace1.Solve_WaterEnergy_AirSoil.ResidueState</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ResidueState(T_r, psi_r, W_r)</code></pre><p>Residue/litter surface node (optional).</p><p><strong>Units</strong></p><p>Same conventions as soil surface:</p><ul><li><code>T_r</code> (K)</li><li><code>psi_r</code> (MPa)</li><li><code>W_r</code> residue water store used to limit evaporation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L238-L248">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState"><code>Ace1.Solve_WaterEnergy_AirSoil.SoilSurfaceState</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SoilSurfaceState(T_s, psi_s, W_s)</code></pre><p>Soil surface node.</p><p><strong>Units</strong></p><ul><li><code>T_s</code> (K)</li><li><code>psi_s</code> (MPa) </li><li><code>W_s</code> : available surface water store used to limit evaporation over a step</li></ul><p><strong>Notes</strong></p><p><code>W_s</code> only needs to be consistent with the limiter in <code>vapor_flux_limited</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L219-L231">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes"><code>Ace1.Solve_WaterEnergy_AirSoil.SurfaceFluxes</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SurfaceFluxes()</code></pre><p>Container of mean fluxes over the time step (or mean over substeps).</p><p><strong>Soil-surface fluxes</strong></p><ul><li><code>Rn_s</code>: net radiation</li><li><code>H_s</code>: sensible heat</li><li><code>LE_s</code>: latent heat</li><li><code>Jh_s</code>: enthalpy advected with mass flux</li><li><code>E_s</code>: vapor mass flux (negative = evaporation)</li></ul><p class="math-container">\[LE_s = \lambda E_s, \qquad Jh_s = E_s c_{p,w} T_{src}\]</p><p><strong>Residue fluxes</strong></p><p>Analogous fields <code>Rn_r</code>, <code>H_r</code>, <code>LE_r</code>, <code>Jh_r</code>, <code>E_r</code>.</p><p><strong>Residue–soil exchange</strong></p><ul><li><code>Q_rs</code>: conductive heat exchange (+ if residue warmer than soil)</li><li><code>Fv_rs</code>: vapor exchange (+ if residue vapor variable &gt; soil)</li><li><code>Jh_rs</code>: enthalpy with <code>Fv_rs</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L398-L421">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling"><code>Ace1.Solve_WaterEnergy_AirSoil.ThermalCoupling</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ThermalCoupling(G_rs_base, use_free_convection, g,beta,nu,alpha,θ,θcrit,Ra_max)

### Residue-soil conductive coupling:
```math
Q_{rs} = G_{rs} * (T_r - T_s)
```

### Optional enhancement: 
```math
G_{rs} = G_{rs,base} \cdot Nu(Ra,Pr)
```

Set `use_free_convection=false` to use `G_rs_base` directly.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L351-L365">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.Solve_Flux_Exchange_Kernel!-Tuple{AirState, SoilSurfaceState, Union{Nothing, ResidueState}, Conductances, RadiationForcing, RadiationForcing, HeatCapacities, ThermalCoupling}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.Solve_Flux_Exchange_Kernel!-Tuple{AirState, SoilSurfaceState, Union{Nothing, ResidueState}, Conductances, RadiationForcing, RadiationForcing, HeatCapacities, ThermalCoupling}"><code>Ace1.Solve_WaterEnergy_AirSoil.Solve_Flux_Exchange_Kernel!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Solve_Flux_Exchange_Kernel!(air, soil, residue, cond, rad_s, rad_r, hc, tc;
            dt, λ, c_pw, C_kelvin=18/R, snow_free=1.0, litter_cover=1.0, nsub=10)</code></pre><p>Advance one time step of the coupled system.</p><p><strong>Methods equations (core)</strong></p><p>Kelvin equilibrium:</p><p class="math-container">\[e^*(T,\psi) = e_{sat}(T)\exp\left(C_{kelvin}\frac{\psi}{T}\right)\]</p><p>Vapor flux (limited):</p><p class="math-container">\[E = g_v(e_a - e^*),\qquad E\ge -\frac{W}{\Delta t}\]</p><p>Heat fluxes:</p><p class="math-container">\[H = g_h(T_a - T),\quad LE=\lambda E,\quad J_h = E c_{p,w} T_{src}\]</p><p>Net radiation:</p><p class="math-container">\[R_n(T) = (1-\alpha)SW + LW_{in} - c_{emit}T^4 + c_{can}(T_{can}^4-T^4)+c_{dead}(T_{dead}^4-T^4)\]</p><p>Residue–soil conduction (if residue present):</p><p class="math-container">\[Q_{rs} = G_{rs}(T_r - T_s)\]</p><p><strong>What this function updates</strong></p><ul><li>Always updates water stores <code>soil.W_s</code> and (if present) <code>residue.W_r</code>.</li><li>Updates temperatures only when corresponding heat capacity is positive:</li><li>if <code>hc.C_s &gt; 0</code>: updates <code>soil.T_s</code></li><li>if <code>hc.C_r &gt; 0</code>: updates <code>residue.T_r</code></li></ul><p><strong>Options</strong></p><ul><li><code>snow_free</code>, <code>litter_cover</code> are multiplicative masks on surface fluxes.</li><li><code>nsub</code> substeps are used when residue is present for numerical stability.</li><li><code>C_kelvin</code> default <code>18/R</code> assumes ψ in <strong>MPa</strong> (ecosys-consistent).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L485-L523">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu-Tuple{Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu-Tuple{Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.dnusselt_churchill_chu</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">dnusselt_churchill_chu(Pr) -&gt; denom</code></pre><p>Churchill–Chu denominator term:</p><p class="math-container">\[\left(1 + (0.492/Pr)^{9/16}\right)^{4/9}\]</p><p>Used in the classic natural-convection correlation for <code>Nu(Ra,Pr)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L134-L143">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin-Tuple{Float64, Float64, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin-Tuple{Float64, Float64, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.e_eq_kelvin</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">e_eq_kelvin(TK, psi; C_kelvin) -&gt; e_star</code></pre><p>Kelvin-corrected equilibrium vapor variable at a surface.</p><p><strong>Equation</strong></p><p class="math-container">\[e^*(T,\psi) = e_{sat}(T)\exp\left(C_{kelvin}\frac{\psi}{T}\right)\]</p><p><strong>Choosing <code>C_kelvin</code> (unit-critical)</strong></p><ul><li><p><strong>(ψ in MPa):</strong></p><p class="math-container">\[C_{kelvin} = \frac{18}{R}\]</p><p>where <code>18</code> arises from <code>V_w * (10^6 Pa/MPa)</code>.</p></li><li><p><strong>strict SI choice (ψ in Pa):</strong></p><p class="math-container">\[C_{kelvin} = \frac{V_w}{R}\]</p><p>with <code>V_w ≈ 18 × 10^-6 m^3 mol^-1</code> and ψ in Pa.</p></li></ul><p><strong>Units</strong></p><ul><li><code>TK</code> (K)</li><li><code>psi</code> (MPa)  </li><li>Output has the same units as <code>e_sat(T)</code> and <code>air.e_a</code> </li></ul><p><strong>Physical meaning</strong></p><p>As soil/residue dries, ψ becomes more negative, <code>e^*</code> decreases, and evaporation is suppressed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L61-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.e_sat-Tuple{Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.e_sat-Tuple{Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.e_sat</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">e_sat(TK) -&gt; e_sat</code></pre><p>Saturated vapor pressure (Pa) at temperature <code>T_K</code> (K).</p><p><strong>Default behavior</strong></p><ul><li>and your conductance <code>g_v</code> is consistent with those units.</li></ul><p><strong>Units</strong></p><ul><li>Input: <code>TK</code> (K)</li><li>Output: vapor pressure (Pa)</li></ul><p><strong>Notes</strong></p><p>Only consistency matters for the bulk-gradient flux:</p><p class="math-container">\[E = g_v (e_a - e^*)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L37-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs-Tuple{Float64, Float64, ThermalCoupling}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs-Tuple{Float64, Float64, ThermalCoupling}"><code>Ace1.Solve_WaterEnergy_AirSoil.effective_G_rs</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">effective_G_rs(T_r, T_s, tc) -&gt; G_rs

Effective residue–soil conductance, optionally enhanced by free convection.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L378-L382">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux-NTuple{4, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux-NTuple{4, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.enthalpy_flux</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">enthalpy_flux(E, c_pw, T_surface, T_air) -&gt; Jh</code></pre><p>Enthalpy flux carried with the water mass transfer.</p><p><strong>Equation</strong>: </p><p class="math-container">\[J_h = E\,c_{p,w}\,T_{src}\]</p><p><strong>Source temperature convention</strong></p><ul><li>If <code>E &lt; 0</code> (evaporation; mass leaves surface), use <code>T_surface</code></li><li>If <code>E &gt; 0</code> (condensation; mass arrives from air), use <code>T_air</code></li></ul><p>This separates “advected sensible heat with mass transfer” from latent heat <code>\lambda E</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L464-L479">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.net_radiation-Tuple{Float64, RadiationForcing}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.net_radiation-Tuple{Float64, RadiationForcing}"><code>Ace1.Solve_WaterEnergy_AirSoil.net_radiation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">net_radiation(T, rad) -&gt; Rn</code></pre><p>Compute net radiation <code>R_n(T)</code> for a surface. See <code>RadiationForcing</code> for the exact equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L319-L324">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu-Tuple{Float64, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu-Tuple{Float64, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.nusselt_churchill_chu</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">nusselt_churchill_chu(Ra, Pr) -&gt; Nu</code></pre><p>Natural convection correlation (Churchill–Chu style), clamped to <code>Nu &gt;= 1</code>:</p><p class="math-container">\[Nu = \max\left(1,\;0.68 + \frac{0.67\,Ra^{1/4}}{\left(1 + (0.492/Pr)^{9/16}\right)^{4/9}}\right)\]</p><p>Interpretation: <code>Nu = 1</code> is pure conduction; <code>Nu &gt; 1</code> enhances effective transport.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L148-L157">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.prandtl-Tuple{Float64, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.prandtl-Tuple{Float64, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.prandtl</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prandtl(nu, alpha) -&gt; Pr</code></pre><p>Prandtl number:</p><p class="math-container">\[Pr = \frac{\nu}{\alpha}\]</p><ul><li><code>nu</code>: kinematic viscosity (momentum diffusivity)</li><li><code>alpha</code>: thermal diffusivity</li></ul><p>Interpretation: compares momentum diffusion to heat diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L100-L112">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous-Tuple{Float64, Float64, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous-Tuple{Float64, Float64, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.rayleigh_porous</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">rayleigh_porous(ΔT, θ, θcrit; g,beta,nu,alpha,Ra_max) -&gt; Ra</code></pre><p>Effective Rayleigh number in a porous phase using a connectivity proxy.</p><ul><li><p>Proxy length scale:</p><p class="math-container">\[L_{eff}^3 := \max(0,\theta - \theta_{crit})^3\]</p></li><li><p>Rayleigh number:</p><p class="math-container">\[Ra = \min\left(Ra_{max},\;\frac{g\beta}{\nu\alpha}\,|\Delta T|\,L_{eff}^3\right)\]</p></li></ul><p>Convection “turns on” only when a phase (air or water) is sufficiently connected above a threshold.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L164-L180">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor-NTuple{4, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor-NTuple{4, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.rayleigh_prefactor</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">rayleigh_prefactor(g, beta, nu, alpha) -&gt; pref</code></pre><p>Rayleigh prefactor:</p><p class="math-container">\[\text{pref} = \frac{g\,\beta}{\nu\,\alpha}\]</p><p>So a Rayleigh number can be formed as:</p><p class="math-container">\[Ra = \text{pref}\,(\Delta T\, L^3)\]</p><p>This appears naturally when nondimensionalizing the Navier–Stokes + heat equation under the Boussinesq approximation (buoyancy-driven flow).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L115-L130">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited-NTuple{5, Float64}"><a class="docstring-binding" href="#Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited-NTuple{5, Float64}"><code>Ace1.Solve_WaterEnergy_AirSoil.vapor_flux_limited</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">vapor_flux_limited(g_v, e_air, e_eq, W_available, dt) -&gt; E</code></pre><p>Compute vapor mass flux with an availability limiter.</p><p>Base flux:</p><p class="math-container">\[E = g_v (e_{air} - e^*)\]</p><p>Limiter (prevents over-evaporation):</p><p class="math-container">\[E \ge -\frac{W}{\Delta t}\]</p><p>Sign</p><ul><li><code>E &lt; 0</code> : evaporation (surface loses water)</li><li><code>E &gt; 0</code> : condensation (surface gains water)</li></ul><p><code>W_available</code> is the surface store used only to enforce this bound.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/hutx2309/Ace1.jl/blob/f1ea57472e8015f462e21e9f8e962125a56e714c/src/water/Solve_WaterEnergy_AirSoil.jl#L434-L454">source</a></section></details></article><p>julia id=&quot;f8y9sq&quot; using Ace1</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../WaterFlux_Exchange_Soil/">WaterFlux<em>Exchange</em>Soil »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 28 February 2026 00:16">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
